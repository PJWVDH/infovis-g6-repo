
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Data schoonmaken &#8212; Tbl-kanker, Luchtvervuiling en Roken</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=384b581d" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=3ee479438cf8b5e0d341" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=3ee479438cf8b5e0d341" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=3ee479438cf8b5e0d341"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=efea14e4"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=36754332"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'docs/cleaning_data';</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Datastory Trachea-, bronchiën- en longkanker" href="notebook.html" />
    <link rel="prev" title="Inleiding" href="home.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="home.html">
  
  
  
  
  
  
    <p class="title logo__title">Tbl-kanker, Luchtvervuiling en Roken</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="home.html">
                    Inleiding
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Data schoonmaken</a></li>


<li class="toctree-l1"><a class="reference internal" href="notebook.html">Datastory Trachea-, bronchiën- en longkanker</a></li>





<li class="toctree-l1"><a class="reference internal" href="reflectie.html">Reflectie</a></li>


</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://colab.research.google.com/github/PJWVDH/infovis-g6-repo/blob/main/docs/docs/cleaning_data.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onColab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/PJWVDH/infovis-g6-repo" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/PJWVDH/infovis-g6-repo/issues/new?title=Issue%20on%20page%20%2Fdocs/cleaning_data.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/docs/cleaning_data.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Data schoonmaken</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Data schoonmaken</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#data-inladen">Data inladen</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#data-opschonen">Data opschonen</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#vergelijking-uitstoot-en-tbl-kanker">Vergelijking uitstoot en TBL Kanker</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#wereldkaartplots-en-usa-india-vergelijkingsplot">Wereldkaartplots en USA/India vergelijkingsplot</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#correlatieplot-emissie-en-tbl-kanker">Correlatieplot Emissie en TBL-kanker</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#correlatieplot-roken-en-longkanker">Correlatieplot roken en longkanker</a></li>
</ul>
</li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="data-schoonmaken">
<h1>Data schoonmaken<a class="headerlink" href="#data-schoonmaken" title="Link to this heading">#</a></h1>
<p>Voor dit project hebben we vier verschillende datasets opgeschoond en samengevoegd. Het eerste en meest uitdagende aspect van deze taak was het harmoniseren van de landnamen. Elk van de datasets gebruikte verschillende namen of codes voor landen, wat directe vergelijking onmogelijk maakte. Om dit op te lossen, hebben we een uniforme lijst van landennamen opgesteld en vervolgens een mapping uitgevoerd om de inconsistenties tussen de datasets te corrigeren. Dit zorgde ervoor dat elk land in alle datasets dezelfde naam kreeg, waardoor een nauwkeurige samensmelting mogelijk werd.
Vervolgens hebben we alle datasets geïnspecteerd om overbodige kolommen te identificeren en te verwijderen. Deze kolommen bevatten gegevens die niet relevant waren voor onze analyse of duplicaten van informatie die al in andere kolommen aanwezig was. Door deze kolommen te verwijderen, hebben we een strakkere, beter beheersbare dataset gekregen.
Na het opschonen van de individuele datasets, hebben we deze samengevoegd op basis van de uniforme landnamen en jaar. De datasets overlappen alleen voor een bepaalde periode van tijd. Dit is de periode van 2001 tot 2012. We hebben de datasets samengevoegd op deze jaren en overbodige jaren verwijderd. Hierdoor ontstond een enkele, geïntegreerde dataset die alle benodigde informatie bevatte zonder overbodige informatie. Deze uiteindelijke dataset bevatte alleen de relevante kolommen die we nodig hadden voor onze analyse, wat de efficiëntie en nauwkeurigheid van ons werk aanzienlijk verbeterde.</p>
<p>Hieronder staan de datasets die wij gebruikt hebben:</p>
<p>Dataset over kankertype en doden: <a class="reference external" href="https://www.kaggle.com/datasets/antimoni/cancer-deaths-by-country-and-type-1990-2016">https://www.kaggle.com/datasets/antimoni/cancer-deaths-by-country-and-type-1990-2016</a>
The Cancer Deaths by Country and Type dataset bevat data van 18 verschillende soorten kanker (prostaatkanker, leverkanker, TBL-kanker etc.) en het dodental per soort kanker per jaar en per land. De data is van 1990-2016. De data is verzameld van de WHO (World Health Organisation).</p>
<p>Deze data gaan we vervolgens naast de dataset over roken leggen:
<a class="reference external" href="https://www.kaggle.com/datasets/mexwell/us-smoking-trend">https://www.kaggle.com/datasets/mexwell/us-smoking-trend</a>
De Global Smoking Trend dataset bevat data over het aantal rokers per land per jaar. De dataset is van 1980-2012.</p>
<p>En daarnaast vergelijken met de dataset van uitstoot:
<a class="reference external" href="https://www.kaggle.com/datasets/thedevastator/global-fossil-co2-emissions-by-country-2002-2022">https://www.kaggle.com/datasets/thedevastator/global-fossil-co2-emissions-by-country-2002-2022</a>
De Emissions by Country dataset bevat mondiale data van fossiele brandstof CO2-uitstoot per land per jaar. De dataset bevat totale CO2-uitstoot per jaar per land maar ook uitstoot per aandeel gas, olie, kolen of uitstoot per inwoner. De dataset is van 1750-2021.</p>
<p>Om data om te zetten naar per capita data, hebben we een dataset gevonden met populatie per land per jaar:
<a class="github reference external" href="https://github.com/datasets/population/blob/main/data/population.csv">datasets/population</a></p>
<p>Continuous / Ratio variabelen: Rokers, TBL-Kanker, Emissies <br>
Discrete / Nominale variabelen: Land <br>
Discrete / Interval variabelen: Jaar <br></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">plotly.express</span> <span class="k">as</span> <span class="nn">px</span>
<span class="kn">import</span> <span class="nn">plotly.graph_objs</span> <span class="k">as</span> <span class="nn">go</span> 
<span class="kn">from</span> <span class="nn">plotly.subplots</span> <span class="kn">import</span> <span class="n">make_subplots</span>
</pre></div>
</div>
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="data-inladen">
<h1>Data inladen<a class="headerlink" href="#data-inladen" title="Link to this heading">#</a></h1>
<p>Eerst worden de juiste datasets ingeladen, dit zijn de vier boven benoemde datasets.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cancer_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;csv/CancerDeaths.csv&quot;</span><span class="p">)</span>
<span class="n">emissions_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;csv/Emissions.csv&quot;</span><span class="p">)</span>
<span class="n">population_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;csv/Population.csv&quot;</span><span class="p">)</span>
<span class="n">smoking_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;csv/smoking.csv&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="data-opschonen">
<h1>Data opschonen<a class="headerlink" href="#data-opschonen" title="Link to this heading">#</a></h1>
<p>Hieronder worden de datasets ‘schoongemaakt’ en opgeslagen in het csv mapje.</p>
<section id="vergelijking-uitstoot-en-tbl-kanker">
<h2>Vergelijking uitstoot en TBL Kanker<a class="headerlink" href="#vergelijking-uitstoot-en-tbl-kanker" title="Link to this heading">#</a></h2>
<p>Onderstaande dataset wordt gecleaned op de datasets van TBL-kanker en Totale emissies. Het wordt vervolgens gecombineerd tot de file ‘emissions_cancer_merged’. Deze zal gebruikt worden voor de subplots. De variabelen die gemerged worden zijn ‘Year’, ‘Tracheal, bronchus, and lung cancer ‘, en ‘Total’ (totale emissies).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># df voor uitstoot en TBL</span>

<span class="c1"># Filter the DataFrame for the desired country and year range</span>
<span class="n">cancer_country</span> <span class="o">=</span> <span class="s1">&#39;World&#39;</span>  <span class="c1"># Replace with the desired country code</span>
<span class="n">emissions_country</span> <span class="o">=</span> <span class="s1">&#39;Global&#39;</span>  <span class="c1"># Replace with the desired country code</span>

<span class="n">cancer_data</span> <span class="o">=</span> <span class="n">cancer_df</span><span class="p">[(</span><span class="n">cancer_df</span><span class="p">[</span><span class="s1">&#39;Country&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">cancer_country</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">cancer_df</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">2001</span><span class="p">)]</span>
<span class="n">emissions_data</span> <span class="o">=</span> <span class="n">emissions_df</span><span class="p">[(</span><span class="n">emissions_df</span><span class="p">[</span><span class="s1">&#39;Country&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">emissions_country</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">emissions_df</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">2001</span><span class="p">)]</span>
<span class="n">cancer_data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="c1"># Extract the Year and Lung cancer columns</span>
<span class="n">year_lung_cancer</span> <span class="o">=</span> <span class="n">cancer_data</span><span class="p">[[</span><span class="s1">&#39;Year&#39;</span><span class="p">,</span> <span class="s1">&#39;Tracheal, bronchus, and lung cancer &#39;</span><span class="p">]]</span>
<span class="n">year_lung_cancer</span> <span class="o">=</span> <span class="n">year_lung_cancer</span><span class="p">[</span><span class="n">year_lung_cancer</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mi">2012</span><span class="p">]</span>

<span class="n">year_total_emissions</span> <span class="o">=</span> <span class="n">emissions_data</span><span class="p">[[</span><span class="s1">&#39;Year&#39;</span><span class="p">,</span> <span class="s1">&#39;Total&#39;</span><span class="p">]]</span>
<span class="n">year_total_emissions</span> <span class="o">=</span> <span class="n">year_total_emissions</span><span class="p">[</span><span class="n">year_total_emissions</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mi">2012</span><span class="p">]</span>

<span class="n">year_total_output</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">year_lung_cancer</span><span class="p">,</span> <span class="n">year_total_emissions</span><span class="p">)</span>

<span class="c1"># Sla de opgeschoonde data op</span>

<span class="n">output_file_total</span> <span class="o">=</span> <span class="s1">&#39;csv/df/emissions_cancer_merged.csv&#39;</span>

<span class="n">year_total_output</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">output_file_total</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">year_total_output</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Year</th>
      <th>Tracheal, bronchus, and lung cancer</th>
      <th>Total</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2001</td>
      <td>1306846.723</td>
      <td>25668.048326</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2002</td>
      <td>1340682.674</td>
      <td>26281.037468</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2003</td>
      <td>1365249.848</td>
      <td>27651.596453</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2004</td>
      <td>1393709.471</td>
      <td>28636.695037</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2005</td>
      <td>1432109.236</td>
      <td>29614.602256</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="wereldkaartplots-en-usa-india-vergelijkingsplot">
<h2>Wereldkaartplots en USA/India vergelijkingsplot<a class="headerlink" href="#wereldkaartplots-en-usa-india-vergelijkingsplot" title="Link to this heading">#</a></h2>
<p>De tweede dataset zal gebruikt worden voor de chloroplets en de vergelijking tussen USA en India. De overeenkomende variabelen waren ‘year’ en ‘country’, en uit de emissions-, cancer-, en smokingdataset worden respectievelijk ‘Data.Smokers.Total’, ‘Tracheal, bronchus, and lung cancer’ en ‘Total’ gehaald. Deze worden vervolgens per variabele gedeeld door de variabele ‘PopTotal’ van de populatie dataset. Dit hebben we gedaan zodat we de per capita values in de dataset konden zetten. Vervolgens hebben we het gemerged in de ‘combined’ dataset en opgeslagen als nieuwe csv.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Data cleaning voor wereldkaartplots en USA/India vergelijkingsplot</span>

<span class="c1"># Load the datasets</span>
<span class="n">df_lung</span> <span class="o">=</span> <span class="n">cancer_df</span>
<span class="n">df_emissions</span> <span class="o">=</span> <span class="n">emissions_df</span>
<span class="n">df_population</span> <span class="o">=</span> <span class="n">population_df</span>
<span class="n">df_smoking</span> <span class="o">=</span> <span class="n">smoking_df</span>

<span class="c1"># Strip any leading/trailing whitespace from column names</span>
<span class="n">df_lung</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">df_lung</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
<span class="n">df_emissions</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">df_emissions</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
<span class="n">df_population</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">df_population</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
<span class="n">df_smoking</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">df_smoking</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>

<span class="c1"># Standardize country names using a mapping dictionary</span>
<span class="n">country_name_mapping</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;Russian Federation&#39;</span><span class="p">:</span> <span class="s1">&#39;Russia&#39;</span><span class="p">,</span>
    <span class="s1">&#39;United States of America&#39;</span><span class="p">:</span> <span class="s1">&#39;USA&#39;</span><span class="p">,</span>
    <span class="s1">&#39;United States&#39;</span><span class="p">:</span> <span class="s1">&#39;USA&#39;</span>
    <span class="c1"># Add other mappings if necessary</span>
<span class="p">}</span>

<span class="c1"># Apply the mapping to the emissions dataset</span>
<span class="n">df_emissions</span><span class="p">[</span><span class="s1">&#39;Country&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_emissions</span><span class="p">[</span><span class="s1">&#39;Country&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">country_name_mapping</span><span class="p">)</span>

<span class="c1"># Apply the mapping to the lung cancer dataset</span>
<span class="n">df_lung</span><span class="p">[</span><span class="s1">&#39;Country&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_lung</span><span class="p">[</span><span class="s1">&#39;Country&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">country_name_mapping</span><span class="p">)</span>

<span class="n">df_smoking</span><span class="p">[</span><span class="s1">&#39;Country&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_smoking</span><span class="p">[</span><span class="s1">&#39;Country&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">country_name_mapping</span><span class="p">)</span>

<span class="n">df_population</span><span class="p">[</span><span class="s1">&#39;Location&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_population</span><span class="p">[</span><span class="s1">&#39;Location&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">country_name_mapping</span><span class="p">)</span>

<span class="c1"># Filter data to include only years 2001-2012</span>
<span class="n">df_lung_filtered</span> <span class="o">=</span> <span class="n">df_lung</span><span class="p">[(</span><span class="n">df_lung</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">2000</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df_lung</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mi">2012</span><span class="p">)]</span>
<span class="n">df_emissions_filtered</span> <span class="o">=</span> <span class="n">df_emissions</span><span class="p">[(</span><span class="n">df_emissions</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">2000</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df_emissions</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mi">2012</span><span class="p">)]</span>
<span class="n">df_smoking_filtered</span> <span class="o">=</span> <span class="n">df_smoking</span><span class="p">[(</span><span class="n">df_smoking</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">2000</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df_smoking</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mi">2012</span><span class="p">)]</span>

<span class="c1"># Merge the lung cancer data with population data</span>
<span class="n">df_lung_merged</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df_lung_filtered</span><span class="p">,</span> <span class="n">df_population</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Country&#39;</span><span class="p">,</span> <span class="s1">&#39;Year&#39;</span><span class="p">],</span> <span class="n">right_on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Location&#39;</span><span class="p">,</span> <span class="s1">&#39;Time&#39;</span><span class="p">])</span>
<span class="n">df_lung_merged</span><span class="p">[</span><span class="s1">&#39;Lung Cancer Per Capita&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_lung_merged</span><span class="p">[</span><span class="s1">&#39;Tracheal, bronchus, and lung cancer&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">df_lung_merged</span><span class="p">[</span><span class="s1">&#39;PopTotal&#39;</span><span class="p">]</span>

<span class="c1"># Merge the emissions data with population data</span>
<span class="n">df_emissions_merged</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df_emissions_filtered</span><span class="p">,</span> <span class="n">df_population</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Country&#39;</span><span class="p">,</span> <span class="s1">&#39;Year&#39;</span><span class="p">],</span> <span class="n">right_on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Location&#39;</span><span class="p">,</span> <span class="s1">&#39;Time&#39;</span><span class="p">])</span>
<span class="n">df_emissions_merged</span><span class="p">[</span><span class="s1">&#39;Emissions Per Capita&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_emissions_merged</span><span class="p">[</span><span class="s1">&#39;Total&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">df_emissions_merged</span><span class="p">[</span><span class="s1">&#39;PopTotal&#39;</span><span class="p">]</span>

<span class="c1"># Merge the smoking data with population data</span>
<span class="n">df_smoking_merged</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df_smoking_filtered</span><span class="p">,</span> <span class="n">df_population</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Country&#39;</span><span class="p">,</span> <span class="s1">&#39;Year&#39;</span><span class="p">],</span> <span class="n">right_on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Location&#39;</span><span class="p">,</span> <span class="s1">&#39;Time&#39;</span><span class="p">])</span>
<span class="n">df_smoking_merged</span><span class="p">[</span><span class="s1">&#39;Smokers Per Capita&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_smoking_merged</span><span class="p">[</span><span class="s1">&#39;Data.Smokers.Total&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">df_smoking_merged</span><span class="p">[</span><span class="s1">&#39;PopTotal&#39;</span><span class="p">]</span>

<span class="c1"># Aggregate data by country, year, and code</span>
<span class="n">df_lung_per_capita</span> <span class="o">=</span> <span class="n">df_lung_merged</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;Country&#39;</span><span class="p">,</span> <span class="s1">&#39;Year&#39;</span><span class="p">])[</span><span class="s1">&#39;Lung Cancer Per Capita&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">df_emissions_per_capita</span> <span class="o">=</span> <span class="n">df_emissions_merged</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;Country&#39;</span><span class="p">,</span> <span class="s1">&#39;Year&#39;</span><span class="p">])[</span><span class="s1">&#39;Emissions Per Capita&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">df_smoking_per_capita</span> <span class="o">=</span> <span class="n">df_smoking_merged</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;Country&#39;</span><span class="p">,</span> <span class="s1">&#39;Year&#39;</span><span class="p">])[</span><span class="s1">&#39;Smokers Per Capita&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>

<span class="c1"># Rename the columns for better readability</span>
<span class="n">df_lung_per_capita</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Country&#39;</span><span class="p">,</span> <span class="s1">&#39;Year&#39;</span><span class="p">,</span> <span class="s1">&#39;Lung Cancer Per Capita&#39;</span><span class="p">]</span>
<span class="n">df_emissions_per_capita</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Country&#39;</span><span class="p">,</span> <span class="s1">&#39;Year&#39;</span><span class="p">,</span> <span class="s1">&#39;Emissions Per Capita&#39;</span><span class="p">]</span>
<span class="n">df_smoking_per_capita</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Country&#39;</span><span class="p">,</span> <span class="s1">&#39;Year&#39;</span><span class="p">,</span> <span class="s1">&#39;Smokers Per Capita&#39;</span><span class="p">]</span>

<span class="c1"># Merge the two datasets on country code and year</span>
<span class="n">df_combined</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df_lung_per_capita</span><span class="p">,</span> <span class="n">df_emissions_per_capita</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Country&#39;</span><span class="p">,</span> <span class="s1">&#39;Year&#39;</span><span class="p">])</span>
<span class="n">df_combined</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df_combined</span><span class="p">,</span> <span class="n">df_smoking_per_capita</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Country&#39;</span><span class="p">,</span> <span class="s1">&#39;Year&#39;</span><span class="p">])</span>

<span class="n">output_file_combined</span> <span class="o">=</span> <span class="s1">&#39;csv/df/combined.csv&#39;</span>
<span class="n">df_combined</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">output_file_combined</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">df_combined</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Country</th>
      <th>Year</th>
      <th>Lung Cancer Per Capita</th>
      <th>Emissions Per Capita</th>
      <th>Smokers Per Capita</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Afghanistan</td>
      <td>2000</td>
      <td>0.000071</td>
      <td>5.358077e-08</td>
      <td>0.062883</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Afghanistan</td>
      <td>2001</td>
      <td>0.000074</td>
      <td>5.430027e-08</td>
      <td>0.064753</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Afghanistan</td>
      <td>2002</td>
      <td>0.000072</td>
      <td>6.385613e-08</td>
      <td>0.063324</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Afghanistan</td>
      <td>2003</td>
      <td>0.000070</td>
      <td>6.887141e-08</td>
      <td>0.061384</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Afghanistan</td>
      <td>2004</td>
      <td>0.000071</td>
      <td>5.252911e-08</td>
      <td>0.061540</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="correlatieplot-emissie-en-tbl-kanker">
<h2>Correlatieplot Emissie en TBL-kanker<a class="headerlink" href="#correlatieplot-emissie-en-tbl-kanker" title="Link to this heading">#</a></h2>
<p>Onderstaand wordt een dataset gecreëerd met de variabelen ‘LungCancerPerCapita’, ‘EmissionsPerCapita’ en ‘Year’, deze zal worden gebruikt voor het maken van het correlatieplot.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># df&#39;s voor correlatieplot emissie en tbl</span>

<span class="c1"># Filter data to include only years 2000-2012</span>
<span class="n">df_lung_filtered</span> <span class="o">=</span> <span class="n">df_lung</span><span class="p">[(</span><span class="n">df_lung</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">2000</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df_lung</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mi">2012</span><span class="p">)]</span>
<span class="n">df_emissions_filtered</span> <span class="o">=</span> <span class="n">df_emissions</span><span class="p">[(</span><span class="n">df_emissions</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">2000</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df_emissions</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mi">2012</span><span class="p">)]</span>
<span class="n">df_population_filtered</span> <span class="o">=</span> <span class="n">df_population</span><span class="p">[(</span><span class="n">df_population</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">2000</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df_population</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mi">2012</span><span class="p">)]</span>

<span class="c1"># Extract relevant columns</span>
<span class="n">df_lung_relevant</span> <span class="o">=</span> <span class="n">df_lung_filtered</span><span class="p">[[</span><span class="s1">&#39;Country&#39;</span><span class="p">,</span> <span class="s1">&#39;Year&#39;</span><span class="p">,</span> <span class="s1">&#39;Tracheal, bronchus, and lung cancer&#39;</span><span class="p">]]</span>
<span class="n">df_emissions_relevant</span> <span class="o">=</span> <span class="n">df_emissions_filtered</span><span class="p">[[</span><span class="s1">&#39;Country&#39;</span><span class="p">,</span> <span class="s1">&#39;Year&#39;</span><span class="p">,</span> <span class="s1">&#39;Total&#39;</span><span class="p">]]</span>
<span class="n">df_population_relevant</span> <span class="o">=</span> <span class="n">df_population_filtered</span><span class="p">[[</span><span class="s1">&#39;Location&#39;</span><span class="p">,</span> <span class="s1">&#39;Time&#39;</span><span class="p">,</span> <span class="s1">&#39;PopTotal&#39;</span><span class="p">]]</span>

<span class="c1"># Merge datasets on Country and Year</span>
<span class="n">df_merged</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df_lung_relevant</span><span class="p">,</span> <span class="n">df_emissions_relevant</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Country&#39;</span><span class="p">,</span> <span class="s1">&#39;Year&#39;</span><span class="p">],</span> <span class="n">right_on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Country&#39;</span><span class="p">,</span> <span class="s1">&#39;Year&#39;</span><span class="p">])</span>
<span class="n">df_merged</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df_merged</span><span class="p">,</span> <span class="n">df_population_relevant</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Country&#39;</span><span class="p">,</span> <span class="s1">&#39;Year&#39;</span><span class="p">],</span> <span class="n">right_on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Location&#39;</span><span class="p">,</span> <span class="s1">&#39;Time&#39;</span><span class="p">])</span>

<span class="c1"># Calculate per capita values</span>
<span class="n">df_merged</span><span class="p">[</span><span class="s1">&#39;LungCancerPerCapita&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_merged</span><span class="p">[</span><span class="s1">&#39;Tracheal, bronchus, and lung cancer&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">df_merged</span><span class="p">[</span><span class="s1">&#39;PopTotal&#39;</span><span class="p">]</span>
<span class="n">df_merged</span><span class="p">[</span><span class="s1">&#39;EmissionsPerCapita&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_merged</span><span class="p">[</span><span class="s1">&#39;Total&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">df_merged</span><span class="p">[</span><span class="s1">&#39;PopTotal&#39;</span><span class="p">]</span>

<span class="c1"># Select only the numeric columns</span>
<span class="n">df_numeric</span> <span class="o">=</span> <span class="n">df_merged</span><span class="p">[[</span><span class="s1">&#39;Year&#39;</span><span class="p">,</span> <span class="s1">&#39;LungCancerPerCapita&#39;</span><span class="p">,</span> <span class="s1">&#39;EmissionsPerCapita&#39;</span><span class="p">]]</span>

<span class="c1"># Group by Year and average the per capita values</span>
<span class="n">df_grouped</span> <span class="o">=</span> <span class="n">df_numeric</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Year&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>

<span class="n">output_file_grouped</span> <span class="o">=</span> <span class="s1">&#39;csv/df/grouped_df.csv&#39;</span>
<span class="n">df_grouped</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">output_file_grouped</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">df_grouped</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Year</th>
      <th>LungCancerPerCapita</th>
      <th>EmissionsPerCapita</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2000</td>
      <td>0.000191</td>
      <td>0.000005</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2001</td>
      <td>0.000192</td>
      <td>0.000005</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2002</td>
      <td>0.000193</td>
      <td>0.000005</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2003</td>
      <td>0.000195</td>
      <td>0.000005</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2004</td>
      <td>0.000197</td>
      <td>0.000005</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="correlatieplot-roken-en-longkanker">
<h2>Correlatieplot roken en longkanker<a class="headerlink" href="#correlatieplot-roken-en-longkanker" title="Link to this heading">#</a></h2>
<p>Hieronder wordt de dataset gecleaned voor de variabelen ‘Year’, ‘LungCancerPerCapita’, ‘SmokersPerCapita’ en ‘CigarettesPerCapita’. Deze zullen gebruikt worden om de correlatieplot voor deze variabelen te creëeren.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># correlatie plot roken en longkanker</span>

<span class="c1"># Extract relevant columns</span>
<span class="n">df_smoking_relevant</span> <span class="o">=</span> <span class="n">df_smoking_filtered</span><span class="p">[[</span><span class="s1">&#39;Country&#39;</span><span class="p">,</span> <span class="s1">&#39;Year&#39;</span><span class="p">,</span> <span class="s1">&#39;Data.Smokers.Total&#39;</span><span class="p">,</span> <span class="s1">&#39;Data.Daily cigarettes&#39;</span><span class="p">]]</span>

<span class="c1"># Merge datasets on Country and Year</span>
<span class="n">df_merged</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df_lung_relevant</span><span class="p">,</span> <span class="n">df_smoking_relevant</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Country&#39;</span><span class="p">,</span> <span class="s1">&#39;Year&#39;</span><span class="p">],</span> <span class="n">right_on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Country&#39;</span><span class="p">,</span> <span class="s1">&#39;Year&#39;</span><span class="p">])</span>
<span class="n">df_merged</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df_merged</span><span class="p">,</span> <span class="n">df_population_relevant</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Country&#39;</span><span class="p">,</span> <span class="s1">&#39;Year&#39;</span><span class="p">],</span> <span class="n">right_on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Location&#39;</span><span class="p">,</span> <span class="s1">&#39;Time&#39;</span><span class="p">])</span>

<span class="c1"># Calculate per capita values</span>
<span class="n">df_merged</span><span class="p">[</span><span class="s1">&#39;LungCancerPerCapita&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_merged</span><span class="p">[</span><span class="s1">&#39;Tracheal, bronchus, and lung cancer&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">df_merged</span><span class="p">[</span><span class="s1">&#39;PopTotal&#39;</span><span class="p">]</span>
<span class="n">df_merged</span><span class="p">[</span><span class="s1">&#39;SmokersPerCapita&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_merged</span><span class="p">[</span><span class="s1">&#39;Data.Smokers.Total&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">df_merged</span><span class="p">[</span><span class="s1">&#39;PopTotal&#39;</span><span class="p">]</span>
<span class="n">df_merged</span> <span class="o">=</span> <span class="n">df_merged</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Data.Daily cigarettes&#39;</span><span class="p">:</span> <span class="s1">&#39;CigarettesPerCapita&#39;</span><span class="p">})</span>

<span class="c1"># Select only the numeric columns</span>
<span class="n">df_numeric</span> <span class="o">=</span> <span class="n">df_merged</span><span class="p">[[</span><span class="s1">&#39;Year&#39;</span><span class="p">,</span> <span class="s1">&#39;LungCancerPerCapita&#39;</span><span class="p">,</span> <span class="s1">&#39;SmokersPerCapita&#39;</span><span class="p">,</span> <span class="s1">&#39;CigarettesPerCapita&#39;</span><span class="p">]]</span>

<span class="c1"># Group by Year and average the per capita values</span>
<span class="n">df_grouped</span> <span class="o">=</span> <span class="n">df_numeric</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Year&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>

<span class="n">output_file_grouped</span> <span class="o">=</span> <span class="s1">&#39;csv/df/grouped_smokers_df.csv&#39;</span>
<span class="n">df_grouped</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">output_file_grouped</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">df_grouped</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Year</th>
      <th>LungCancerPerCapita</th>
      <th>SmokersPerCapita</th>
      <th>CigarettesPerCapita</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2000</td>
      <td>0.000187</td>
      <td>0.131518</td>
      <td>18.491975</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2001</td>
      <td>0.000189</td>
      <td>0.130765</td>
      <td>18.483951</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2002</td>
      <td>0.000190</td>
      <td>0.129956</td>
      <td>18.470370</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2003</td>
      <td>0.000192</td>
      <td>0.129062</td>
      <td>18.472222</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2004</td>
      <td>0.000193</td>
      <td>0.128358</td>
      <td>18.438272</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./docs"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="home.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Inleiding</p>
      </div>
    </a>
    <a class="right-next"
       href="notebook.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Datastory Trachea-, bronchiën- en longkanker</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Data schoonmaken</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#data-inladen">Data inladen</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#data-opschonen">Data opschonen</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#vergelijking-uitstoot-en-tbl-kanker">Vergelijking uitstoot en TBL Kanker</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#wereldkaartplots-en-usa-india-vergelijkingsplot">Wereldkaartplots en USA/India vergelijkingsplot</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#correlatieplot-emissie-en-tbl-kanker">Correlatieplot Emissie en TBL-kanker</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#correlatieplot-roken-en-longkanker">Correlatieplot roken en longkanker</a></li>
</ul>
</li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Berend, Stef, Wijnand
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=3ee479438cf8b5e0d341"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=3ee479438cf8b5e0d341"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>